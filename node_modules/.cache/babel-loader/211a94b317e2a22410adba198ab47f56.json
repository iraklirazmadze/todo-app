{"ast":null,"code":"'use strict';\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n/**\n * Return a function that will run a function asynchronously or synchronously\n *\n * example:\n * runAsync(wrappedFunction, callback)(...args);\n *\n * @param   {Function} func  Function to run\n * @param   {Function} cb    Callback function passed the `func` returned value\n * @return  {Function(arguments)} Arguments to pass to `func`. This function will in turn\n *                                return a Promise (Node >= 0.12) or call the callbacks.\n */\n\n\nvar runAsync = module.exports = function (func, cb) {\n  cb = cb || function () {};\n\n  return function () {\n    var args = arguments;\n    var promise = new Promise(function (resolve, reject) {\n      var resolved = false;\n\n      const wrappedResolve = function (value) {\n        if (resolved) {\n          console.warn('Run-async promise already resolved.');\n        }\n\n        resolved = true;\n        resolve(value);\n      };\n\n      var rejected = false;\n\n      const wrappedReject = function (value) {\n        if (rejected) {\n          console.warn('Run-async promise already rejected.');\n        }\n\n        rejected = true;\n        reject(value);\n      };\n\n      var usingCallback = false;\n      var callbackConflict = false;\n      var contextEnded = false;\n      var answer = func.apply({\n        async: function () {\n          if (contextEnded) {\n            console.warn('Run-async async() called outside a valid run-async context, callback will be ignored.');\n            return function () {};\n          }\n\n          if (callbackConflict) {\n            console.warn('Run-async wrapped function (async) returned a promise.\\nCalls to async() callback can have unexpected results.');\n          }\n\n          usingCallback = true;\n          return function (err, value) {\n            if (err) {\n              wrappedReject(err);\n            } else {\n              wrappedResolve(value);\n            }\n          };\n        }\n      }, Array.prototype.slice.call(args));\n\n      if (usingCallback) {\n        if (isPromise(answer)) {\n          console.warn('Run-async wrapped function (sync) returned a promise but async() callback must be executed to resolve.');\n        }\n      } else {\n        if (isPromise(answer)) {\n          callbackConflict = true;\n          answer.then(wrappedResolve, wrappedReject);\n        } else {\n          wrappedResolve(answer);\n        }\n      }\n\n      contextEnded = true;\n    });\n    promise.then(cb.bind(null, null), cb);\n    return promise;\n  };\n};\n\nrunAsync.cb = function (func, cb) {\n  return runAsync(function () {\n    var args = Array.prototype.slice.call(arguments);\n\n    if (args.length === func.length - 1) {\n      args.push(this.async());\n    }\n\n    return func.apply(this, args);\n  }, cb);\n};","map":{"version":3,"names":["isPromise","obj","then","runAsync","module","exports","func","cb","args","arguments","promise","Promise","resolve","reject","resolved","wrappedResolve","value","console","warn","rejected","wrappedReject","usingCallback","callbackConflict","contextEnded","answer","apply","async","err","Array","prototype","slice","call","bind","length","push"],"sources":["/home/razma/node_modules/run-async/index.js"],"sourcesContent":["'use strict';\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n\n/**\n * Return a function that will run a function asynchronously or synchronously\n *\n * example:\n * runAsync(wrappedFunction, callback)(...args);\n *\n * @param   {Function} func  Function to run\n * @param   {Function} cb    Callback function passed the `func` returned value\n * @return  {Function(arguments)} Arguments to pass to `func`. This function will in turn\n *                                return a Promise (Node >= 0.12) or call the callbacks.\n */\n\nvar runAsync = module.exports = function (func, cb) {\n  cb = cb || function () {};\n\n  return function () {\n\n    var args = arguments;\n\n    var promise = new Promise(function (resolve, reject) {\n      var resolved = false;\n      const wrappedResolve = function (value) {\n        if (resolved) {\n          console.warn('Run-async promise already resolved.')\n        }\n        resolved = true;\n        resolve(value);\n      }\n\n      var rejected = false;\n      const wrappedReject = function (value) {\n        if (rejected) {\n          console.warn('Run-async promise already rejected.')\n        }\n        rejected = true;\n        reject(value);\n      }\n\n      var usingCallback = false;\n      var callbackConflict = false;\n      var contextEnded = false;\n\n      var answer = func.apply({\n        async: function () {\n          if (contextEnded) {\n            console.warn('Run-async async() called outside a valid run-async context, callback will be ignored.');\n            return function() {};\n          }\n          if (callbackConflict) {\n            console.warn('Run-async wrapped function (async) returned a promise.\\nCalls to async() callback can have unexpected results.');\n          }\n          usingCallback = true;\n          return function (err, value) {\n            if (err) {\n              wrappedReject(err);\n            } else {\n              wrappedResolve(value);\n            }\n          };\n        }\n      }, Array.prototype.slice.call(args));\n\n      if (usingCallback) {\n        if (isPromise(answer)) {\n          console.warn('Run-async wrapped function (sync) returned a promise but async() callback must be executed to resolve.');\n        }\n      } else {\n        if (isPromise(answer)) {\n          callbackConflict = true;\n          answer.then(wrappedResolve, wrappedReject);\n        } else {\n          wrappedResolve(answer);\n        }\n      }\n      contextEnded = true;\n    });\n\n    promise.then(cb.bind(null, null), cb);\n\n    return promise;\n  }\n};\n\nrunAsync.cb = function (func, cb) {\n  return runAsync(function () {\n    var args = Array.prototype.slice.call(arguments);\n    if (args.length === func.length - 1) {\n      args.push(this.async());\n    }\n    return func.apply(this, args);\n  }, cb);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}